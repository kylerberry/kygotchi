$("document").ready(function(){Kygotchi.init({gotchi:"#gotchi",bindings:{feed:"#feed",play:"#play",reset:"#reset",sleep:"#sleep",wake:"#wake",medicine:"#medicine"}})});var Animate=function(){var a="",b=null;return this.init=function(c){a=$(c),a.hasClass("dead")&&a.removeClass("dead"),b&&clearInterval(b),b=setInterval(function(){Math.floor(10*Math.random())%4==0&&this.blink()},1e3)},this.blink=function(){a.addClass("blink"),setTimeout(function(){a.removeClass("blink")},200)},this.to=function(b){b||b===c||a.removeClass(),a.hasClass(b)||(a.removeClass(),b&&a.addClass(b));var c=b},this.die=function(){clearInterval(b),a.removeClass(),a.addClass("dead")},this}(),Kygotchi=function(a){var b=localStorage.getItem("gotchi")?JSON.parse(localStorage.getItem("gotchi")):{},c={birthday:new Date("September 22, 1987"),isSleeping:!1,foodLevel:10,restLevel:10,happinessLevel:10,last_interaction:"date"},d=$.extend(d,c,b),e={},f=15,g=2e3,h=null,i=2,j={},k={};d.init=function(b){e=$.extend(e,b.bindings),$.each(e,function(a,b){$(b).on("click",d[a])}),k=StateMachine.create({error:function(a){console.log(a+' cannot be called from "'+k.current+'" state')},events:[{name:"_normal_health",from:["none","happy","sad"],to:"neutral"},{name:"_low_health",from:["none","neutral"],to:"sad"},{name:"_high_health",from:["none","neutral"],to:"happy"},{name:"_sleep",from:["none","happy","neutral","sad"],to:"sleep"},{name:"_feed",from:["sad","neutral","happy"],to:"none"},{name:"_wake",from:["sleep"],to:"none"},{name:"_die",from:["sad","sleep"],to:"dead"}],callbacks:{on_normal_health:function(){a.to("neutral")},on_high_health:function(){a.to("happy")},on_low_health:function(){a.to("sad")},on_sleep:function(){a.to("sleep"),p()},on_wake:function(){return a.to(),d.update(),p(),!1},on_feed:function(){return a.to("eating"),d.foodLevel&&d.foodLevel++,setTimeout(function(){return a.to(),d.update(),p(),!1},1e3),StateMachine.ASYNC},on_die:function(){a.die(),clearInterval(h),localStorage.removeItem("gotchi"),n()}}}),h=o(),j=b.gotchi?b.gotchi:j,a.init(j),d.update()},d.sleep=function(){k._sleep()},d.wake=function(){k._wake()},d.feed=function(){k._feed()},d.play=function(){d.isSleeping?console.log("happy dreams"):d.happinessLevel<f&&d.happinessLevel++,p()},d.medicine=function(){d.calcHealth()<f&&i&&!d.isSleeping&&(d.happinessLevel<f&&d.happinessLevel++,d.restLevel<f&&d.restLevel++,i--),p()},d.reset=function(){d=$.extend(d,c),clearInterval(h),n(),d.init(e)},d.isAlive=function(){return Boolean(d.calcHealth()>2&&d.foodLevel)},d.calcHealth=function(){var a=(d.foodLevel+d.happinessLevel+d.restLevel)/3;return a>=f?f:Math.floor(a)},d.save=function(){localStorage.setItem("gotchi",JSON.stringify(l(d,Object.keys(c))))};var l=function(a,b){var c={};return b.forEach(function(b){a.hasOwnProperty(b)&&(c[b]=a[b])}),c},m=function(){d.foodLevel&&d.foodLevel--,d.happinessLevel&&d.happinessLevel--,k.is("sleep")?d.restLevel<f&&d.restLevel++:d.restLevel&&d.restLevel--,d.update()};d.update=function(){var a=d.calcHealth();if(a>8)k._high_health();else if(a>5&&8>=a)k._normal_health();else{if(!(5>=a&&a>2))return void k._die();k._low_health()}d.save()};var n=function(){$.each(e,function(a,b){"reset"!==a&&$(b).off()})},o=function(){return p(),setInterval(function(){m(),p()},g)},p=function(){$("#debug").html("healthLevel: "+d.calcHealth()+"<br/>foodLevel: "+d.foodLevel+"<br/>happinessLevel: "+d.happinessLevel+"<br/>restLevel: "+d.restLevel+"<br/>")};return d}(Animate||{});
//# sourceMappingURL=built.min.js.map